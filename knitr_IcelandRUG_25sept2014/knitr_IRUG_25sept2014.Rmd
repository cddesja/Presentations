---
title: "Creating reproducible research with `knitr`"
author: "Christopher David Desjardins"
date: "26 September 2014"
output:
  ioslides_presentation:
    keep_md: yes
---

## What is reproducible research?
 
```{r, echo=FALSE}
library("knitr")
```
 
"The final product of research is not only the paper itself, but also the full __computation environment__ used to produce the results in the paper such as the __code__ and __data__ necessary for reproduction of the results and building upon the research." (Xie, 2014).

Articles submitted for journals should include:

- Manuscript
- Code 
- Data

Obviously, this is not always possible!

## Tools for reproduciblity

- [R](http://r-project.org)
- [knitr](http://yihui.name/knitr/)
- [Markdown](http://daringfireball.net/projects/markdown/) or [LaTeX](http://www.latex-project.org/)

Which one should you use, see [Yihue Xie's post](http://yihui.name/en/2013/10/markdown-or-latex/). 

- [Rstudio](http://www.rstudio.com) (_recommended_)

The developers of Rstudio are often the first to integrate the latest and greatest from `R`.

## Why `knitr`?

```{r, eval=FALSE}
install.packages("knitr")
```

How can `knitr` help us achieve reproducibility?

1. We __never__ need to copy and paste results into reports.
2. If the data changes, our models, figures, and tables are __automatically updated__.
3. From a `knitr` document we can automatically generate the output using `knit()` or extract the `R` code from an input document using `purl()`.
5. Generate a document for an `R` script with `stitch()`.
4. It is much more feature rich than Sweave.

## Markdown demonstration

```{r, eval = FALSE}
if(!require("shiny"))
  install.packages("shiny")
demo("notebook", package = "knitr")
```

## Input syntax

Input is evaluated in chunks. Either __code chunks__

    ```{r}`r ''`
    <insert R code for Markdown>
    ```

    <<>>=`r ''`
    <insert R code for LaTeX>
    @

Or as __inline R code__
```{r, echo = FALSE, comment=NA}
cat("`r <insert R for Markdown> `\n\n\\Sexpr{ <insert R code for LaTeX> }")
```


## Chunks


Chunks have a plethora of options. These options include: setting labels, whether the input/output should be hidden, whether all/some of the code should be evaluated, how to handle messages, etc. 

```{r}
length(opts_chunk$get())
opts_chunk$get("engine")
```

## Tables

Tables are easily handled with `xtable`. Make sure to specify `results = "asis"` to render the table. 
```{r, results = "asis",echo=FALSE}
library(xtable)
mod1 <- lm(dist ~ speed, data = cars)
coef_tab <- summary(mod1)$coef
print(xtable(mod1), type = "html")
```
<p>
</p>
Finer control of tables with LaTeX. Finally, we insert our fitted model using inline code:

$\hat{dist_i} = `r coef_tab[1,1]` + `r coef_tab[2,1] ` speed_i$

## Code used
    ```{r, results = "asis", echo=FALSE}`r ''`
    library(xtable)
    mod1 <- lm(dist ~ speed, data = cars)
    coef_tab <- summary(mod1)$coef
    print(xtable(mod1), type = "html")
    ```
    
For the inline code:
```{r,comment = NA, echo = FALSE}
cat("$\\hat{dist_i} = `r coef_tab[1,1]` + `r coef_tab[2,1] ` speed_i$")
```


## Using an ioslides table

-------------------------------------------------------------
Coefficients     Estimate     Standard    t-value     Pr(>|t|)
                              Error   
-------------- ------------ ----------- ----------- ------------
`r rownames(coef_tab)[1] `    `r coef_tab[1,1]`       `r coef_tab[1,2]`       `r coef_tab[1,3]`       `r coef_tab[1,4]`  

`r rownames(coef_tab)[2] `            `r coef_tab[2,1]`       `r coef_tab[2,2]`       `r coef_tab[2,3]`       `r coef_tab[2,4]`  
-------------------------------------------------------------


